# 讀書儀表板

這是一個自動更新的儀表板，用來追蹤您的閱讀進度。
它會自動從 `80_Personal/Reading` 資料夾中所有包含特定元數據的筆記來抓取資料。

---
``` dataviewjs
const pages = dv.pages('"80_Personal/Reading"').where(p => (p.title && p.category) && p.file.path != dv.current().file.path);
const thisYear = dv.date("today").year;

// 統計數字
const totalFinished = pages.where(p => p.finishDate && p.finishDate.year).length;
const finished = pages.where(p => p.finishDate && p.finishDate.year && dv.date(p.finishDate).year == thisYear).length;
const reading = pages.where(p => p.startDate && !(p.finishDate && p.finishDate.year)).length;
const notStarted = pages.where(p => !p.startDate).length;

// 以 Markdown 表格輸出
dv.paragraph("## 📚 閱讀統計");
dv.table(
    ["歷史已讀", "今年已讀", "正在閱讀", "未開始"],
    [[`${totalFinished} 本`, `${finished} 本`, `${reading} 本`, `${notStarted} 本`]]
);
```

---

## 📖 正在閱讀

```dataview
TABLE WITHOUT ID
    "![|100](" + cover + ")" as "縮圖",
    link(file.link, title) as "書名",
    default(author, "<i>N/A</i>") as "作者",
    choice(currentPage AND totalPages,
        "<progress value='" + currentPage + "' max='" + totalPages + "'></progress>" + " " + (round(currentPage / totalPages * 100)) + "%",
        "<i>未追蹤</i>"
    ) as "進度"
WHERE contains(file.folder, "80_Personal/Reading") AND file.path != this.file.path AND (title AND category) AND startDate AND !finishDate
SORT startDate DESC
```

---

## ✅ 今年已讀完

```dataview
TABLE WITHOUT ID
    "![|100](" + cover + ")" as "縮圖",
    link(file.link, title) as "書名",
    default(author, "<i>N/A</i>") as "作者",
    choice(rating, ("★" * rating) + ("☆" * (5 - rating)), "<i>未評分</i>") as "評分",
    category as "分類",
    dateformat(finishDate, "yyyy/MM/dd") as "完成閱讀"
WHERE contains(file.folder, "80_Personal/Reading") AND file.path != this.file.path AND (title AND category) AND finishDate AND date(finishDate).year = date("today").year
SORT finishDate DESC
```

---

### 如何使用

要在這個儀表板中顯示一本書，請在該書的筆記最上方加入以下的 YAML 元數據區塊，並根據實際情況修改內容：

```yaml
---
cover: "書籍封面圖片的網址"
title: "書名"
author: "作者名稱"
category: ["分類1", "分類2"]
status: "reading" # 可填 reading 或 finished
startDate: YYYY-MM-DD
finishDate: YYYY-MM-DD # 如果還沒讀完，可以留白
rating: 5 # 1-5 的評分 (讀完後填寫)
totalPages: 300 # 總頁數 (閱讀中填寫)
currentPage: 150 # 目前頁數 (閱讀中填寫)
---
```