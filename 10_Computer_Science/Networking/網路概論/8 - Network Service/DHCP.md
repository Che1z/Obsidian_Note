### 1. DHCP（Dynamic Host Configuration Protocol）

**DHCP** 是一種網路協議，用於自動分配 IP 地址和其他網路配置（如子網路遮罩、閘道和 DNS 伺服器）給網路上的設備。當設備連接到網路時，DHCP 允許該設備自動獲得所需的網路資訊，而無需手動配置。這對於大型網路管理非常方便，尤其是在企業和家庭環境中。

#### DHCP 的工作流程

以下是 DHCP 協議的基本工作流程（也稱為 DHCP DORA 流程）：

1. **DHCP Discover**：當設備（例如電腦或手機）首次連接到網路時，會發送一個廣播請求（DHCP Discover）來尋找 DHCP 伺服器。
    
2. **DHCP Offer**：DHCP 伺服器接收到 Discover 請求後，會從其 IP 池中選擇一個可用的 IP 地址，並將該地址和其他配置信息打包在 DHCP Offer 消息中回應設備。
    
3. **DHCP Request**：設備收到一個或多個 DHCP Offer 後，會選擇其中一個（通常是第一個收到的）並回應 DHCP Request，請求分配該特定的 IP 地址。
    
4. **DHCP Acknowledgment（ACK）**：DHCP 伺服器接收到 DHCP Request 後，確認該 IP 地址可以分配，並發送一個 DHCP ACK（確認）消息給設備，完成 IP 地址的分配。設備接收後，就可以開始使用這個 IP 地址。
    

> 這個流程的目的，是確保每個設備可以從 DHCP 伺服器獲得唯一的 IP 地址，並正確配置網路參數。

---

### 2. DHCP Binding（DHCP 綁定）

**DHCP Binding** 是指 DHCP 伺服器記錄並綁定設備的 MAC 地址和分配的 IP 地址之間的對應關係。這樣可以確保相同的設備每次連接到網路時，仍然能獲得同一個 IP 地址（稱為 DHCP 靜態綁定），或者 DHCP 伺服器可以追踪並管理設備的 IP 地址分配情況（稱為 DHCP 動態綁定）。

#### DHCP 靜態綁定

- **靜態綁定** 是 DHCP 伺服器將某個設備的 MAC 地址和特定 IP 地址綁定在一起，即使設備重新連接到網路，仍然會獲得相同的 IP 地址。
- 這在需要固定 IP 地址的設備上（如伺服器、打印機等）特別有用，因為固定 IP 地址有助於穩定連接和配置。

#### DHCP 動態綁定

- **動態綁定** 是 DHCP 伺服器臨時為設備分配的 IP 地址，當設備斷開連接並超過租約期（lease time）後，DHCP 伺服器可以回收並將該 IP 地址分配給其他設備。
- 適用於一般的用戶端設備（如筆記本電腦、手機），因為這些設備通常不需要固定 IP 地址。

---

### 3. 設備、Router 和 DHCP Server 的關聯與運作範例

在一般網路環境中，<mark style="background: #FFF3A3A6;">路由器通常會內建 DHCP 伺服器</mark>，來負責網路內的設備分配 IP 地址。以下是一個簡單的設備、路由器、DHCP 伺服器的關聯和工作流程範例：

#### 範例場景

- **設備**：一台筆記型電腦，初次連接到公司網路。
- **Router（路由器）**：網路的核心設備 ，負責數據路由和轉發，並內建 DHCP 伺服器功能。
- **DHCP Server（DHCP 伺服器）**：路由器上的 DHCP 服務，用來管理和分配 IP 地址。

#### 運作流程

1. **筆記型電腦接入網路**：當筆記型電腦連接到 Wi-Fi 或 LAN 時，它會向網路發送一個 DHCP Discover 廣播消息，尋找 DHCP 伺服器。
    
2. **路由器回應 DHCP Offer**：路由器的內建 DHCP 伺服器接收到 Discover 消息，選擇一個可用的 IP 地址（例如 192.168.1.100）並打包 DHCP Offer，將此消息回傳給筆記型電腦。
    
3. **筆記型電腦發送 DHCP Request**：筆記型電腦收到 DHCP Offer 後，向路由器發送 DHCP Request 請求指定的 IP 地址（192.168.1.100）。
    
4. **路由器確認並綁定 IP（DHCP ACK）**：路由器的 DHCP 伺服器接收到 DHCP Request 後，發送 DHCP ACK 訊息，確認該 IP 地址分配給筆記型電腦，並在 DHCP 綁定表中記錄該 IP 地址和筆記型電腦的 MAC 地址。
    
5. **設備網路配置完成**：筆記型電腦收到 DHCP ACK 後，完成 IP 地址分配流程，並可以使用網路。
    
6. **租約期與 IP 回收**：如果筆記型電腦長時間離線超過 DHCP 的租約期（lease time），則 DHCP 伺服器會自動回收這個 IP 地址，以便分配給其他設備。
    

---

### 總結

- **DHCP** 負責自動分配 IP 地址和其他網路參數，讓設備自動加入網路並正確配置。
- **DHCP Binding** 是 DHCP 伺服器在分配 IP 地址時記錄 MAC 地址與 IP 地址的對應關係。靜態綁定用於需要固定 IP 地址的設備，動態綁定則適用於一般設備。
- **設備、路由器和 DHCP 伺服器的工作關係** 是設備透過 DHCP 流程（Discover、Offer、Request、ACK）與 DHCP 伺服器（通常由路由器承擔）互動，獲得 IP 地址並配置網路，確保設備能夠在網路中正常通訊。