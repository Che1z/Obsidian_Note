IP 路由（IP Routing）是指在網絡中根據目的地 IP 地址決定數據包傳送路徑的過程。
這一過程涉及多個步驟，包括路由表的建立、數據包的發送及轉發。
以下是 IP 路由的詳細過程：

### 1. 路由表的建立

路由表是每個路由器用來決定如何轉發數據包的重要資料結構。
它包含了目的地 IP 網段、對應的下一跳地址（next-hop）、和路由的度量（metric）等信息。
路由表的建立可以通過以下方式：

- **靜態路由**：
    
    - 網絡管理員手動在路由器上配置路由條目。靜態路由適用於網絡結構相對穩定的環境。
    - 例如，管理員可能會設定路由器知道如何到達 `192.168.2.0/24` 網段，並指向一個特定的下一跳地址。
- **動態路由**：
    
    - 路由器使用動態路由協議（如 RIP、OSPF、EIGRP）來自動學習和更新路由表。
      這些協議通過交換路由信息來確保路由表中的信息是最新的。
    - 路由器會定期或根據網絡變化（如鏈路故障或新增路由）來更新路由表。

### 2. 數據包的發送

當主機需要發送數據包時，它會檢查目的地 IP 地址，並執行以下步驟：

- **檢查路由表**：
    
    - 主機或路由器會查閱其路由表，找到與目的地 IP 地址相匹配的條目，確定要將數據包發送到哪個下一跳地址。
- **決定轉發方式**：
    
    - 如果目的地 IP 在同一子網，數據包將被直接發送到該目的地。
    - 如果目的地 IP 在不同的子網，數據包將被發送到預設閘道（default gateway）。

### 3. 數據包的轉發

- **到達下一跳路由器**：
    
    - 數據包首先被發送到選定的下一跳路由器。下一跳路由器重複上述過程，查詢其路由表以確定如何進一步轉發數據包。
- **持續轉發**：
    
    - 數據包將在網絡中的多個路由器之間進行轉發，直到到達目的地網段。

### 4. 數據包的最終送達

- **最終目的地**：
    - 當數據包到達目的地的網段時，最後一個路由器會將數據包發送給目的地主機。這通常通過查找目的地主機的 MAC 地址來完成，並使用 ARP 協議進行 IP 到 MAC 的映射。

### 總結

整個 IP 路由的過程涵蓋了路由表的建立、數據包的查詢與轉發、以及最終的數據包送達。路由表的準確性和及時更新對於確保數據包高效傳輸至關重要，而動態路由協議的使用則能有效適應網絡拓撲的變化。