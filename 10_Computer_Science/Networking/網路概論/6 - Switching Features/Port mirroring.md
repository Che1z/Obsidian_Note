**Port Mirroring**（端口鏡像）是一種交換機功能，它允許將一個或多個網路埠的流量鏡像到另一個指定的埠，便於網路管理員監控和分析網路流量。
這項功能在網路故障排查、性能監控以及安全分析中非常有用，因為它可以讓管理員在不干擾網路運行的情況下觀察特定數據流。

### Port Mirroring 的運作方式

在 Port Mirroring 中，交換機配置了一個「鏡像埠」（Monitor Port 或 Destination Port），用於接收來自一個或多個「源埠」（Source Port）上的鏡像流量。當源埠上的封包經過交換機時，它的副本會被送到鏡像埠，供連接的設備（如網路分析儀或防火牆）進行觀察和分析。

#### Key Concepts:

1. **Source Port**：待監控的網路埠，通常是被鏡像的對象。
2. **Destination Port**：接收鏡像流量的埠，通常連接到網路分析設備，如 Wireshark、入侵偵測系統（IDS）、或防火牆。
3. **單向或雙向流量鏡像**：可以配置鏡像單向流量（傳入或傳出），也可以鏡像雙向流量。

### Port Mirroring 的使用情境

1. **網路故障排查**：當網路連接出現問題時，可以利用 Port Mirroring 將有問題的端口流量鏡像到分析端口，藉此分析封包內容，找出故障原因。
    
2. **性能監控**：Port Mirroring 能讓網路管理員檢查網路設備的流量數據和延遲情況，從而對網路流量進行性能分析，調整網路負載分配。
    
3. **安全性監控**：通過鏡像關鍵設備或網路邊界的流量，可以進行流量模式分析，識別可能的惡意活動，例如異常流量、端口掃描或 DDoS 攻擊。
    

### Port Mirroring 的局限性

- **資源消耗**：交換機需要額外資源來處理流量鏡像，若鏡像的數量過多，可能會影響交換機性能。
- **頻寬需求**：若源埠的流量過大，可能超出鏡像埠的頻寬，導致封包遺失或鏡像數據不完整。
- **單向監控**：由於鏡像是被動操作，它無法對數據進行改變或阻擋，也無法直接干預流量。

### Port Mirroring 的配置方式

在交換機上，Port Mirroring 可以根據以下幾種方法來配置：

1. **Local Port Mirroring**：在單台交換機內部進行埠鏡像，流量不會跨交換機傳輸。
2. **Remote Port Mirroring (RSPAN)**：在跨交換機環境中配置，允許將流量鏡像到遠端的交換機或監控設備，但需要額外設定以便鏡像流量跨越交換機傳輸。

### 具體應用範例

假設一台交換機上有三個端口，分別連接了伺服器 A、B 和 C。如果想要監控伺服器 A 和 B 之間的流量，可以將伺服器 A 和 B 的埠配置為源埠，將連接到網路分析儀（如 Wireshark）的埠設置為鏡像埠。這樣，來自伺服器 A 和 B 的數據流量會鏡像到網路分析儀，供管理員分析網路狀況。

### 總結

Port Mirroring 是一種強大的網路管理工具，透過鏡像特定端口流量到監控設備，可以在不影響網路服務的情況下進行流量分析。這項技術適合用於排查網路故障、進行性能監控，以及檢測潛在的安全問題。
