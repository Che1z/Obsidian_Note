2024/10/24

![[Pasted image 20241024141220.png]]
重點： MAC Protocol
如何將`frame`用`MAC Protocol`傳給直接相連的主機或設備

### 資料鏈路層（Data Link Layer）

1. **Frame（幀）**：
    
    - Frame是指在資料鏈路層傳送資料的單位，它封裝了從網路層傳遞過來的資料包，並添加了必要的控制資訊，如源和目的MAC地址、錯誤檢查碼等。幀的主要功能是確保在物理層之上可靠地傳輸資料。
2. **媒介存取控制（MAC）**：
    
    - **MAC**（Media Access Control）是資料鏈路層中的一個重要組件，負責控制對共享媒介的存取。它確保不同設備可以在相同的通道上進行有效的資料傳送。
    - 資料鏈路層的主要任務是根據MAC協議，將幀傳送至直接相連的主機或設備。
3. **多重存取（Multiple Access）**：
    
    - 在多重存取情況下，可能會有多個端點同時嘗試傳送資料，這樣會導致碰撞，從而損壞資料。碰撞發生後，必須採取適當的措施來重新傳送資料。
4. **MAC協議**：
    
    - **IEEE 802.3 的 CSMA/CD**（Carrier Sense Multiple Access with Collision Detection）是最常見的MAC協議之一：
        - **CS（Carrier Sense）**：指設備在傳送資料之前必須檢查媒介是否空閒。如果發現媒介正在被使用，設備將暫時停止傳送，等待直到媒介變為空閒。
        - **CD（Collision Detection）**：在傳送資料的過程中，設備會持續監控媒介以檢測碰撞。如果發生碰撞，所有參與的設備會停止傳送資料，並執行一個重傳機制，通常使用隨機延遲時間來降低再次碰撞的概率。
5. **碰撞的處理**：
    
    - 當檢測到碰撞時，設備會執行以下步驟：
        - 停止傳送資料。
        - 發送一個碰撞信號通知所有設備。
        - 等待一段隨機時間（回退時間）後，重新嘗試傳送資料。

### 幀(`Frame`)結構概覽
### 1. **Trailer（尾部）**

- **定義**：Trailer是資料幀的尾部，通常位於幀的最後一部分。它的主要目的是提供錯誤檢查功能。
- **功能**：
    - **錯誤檢查**：最常見的尾部成分是循環冗餘檢查（CRC, Cyclic Redundancy Check）。這是一種檢查碼，用於檢測在傳輸過程中發生的錯誤。接收方可以使用這個檢查碼來驗證幀是否在傳送過程中受到了損壞。
    - **幀結束的標識**：在某些協議中，Trailer也可以用來標識幀的結束，確保接收方正確解析幀的邊界。

### 2. **Source Address (SA)（源地址）**

- **定義**：源地址是發送幀的設備的媒介存取控制（MAC）地址。
- **功能**：
    - **識別發送者**：SA用於唯一識別發送資料的設備，接收方可以通過SA來確定幀的來源。
    - **回應傳送**：當接收方需要向發送方回應時，會使用源地址來決定回傳的目的地。

### 3. **Destination Address (DA)（目的地址）**

- **定義**：目的地址是接收幀的設備的MAC地址。
- **功能**：
    - **識別接收者**：DA用於唯一識別希望接收資料的設備。當幀到達網絡，交換機或集線器會檢查DA來決定幀應該發送到哪個端口。
    - **路由決策**：在許多網絡設備中，DA會被用來執行路由決策，確保資料能夠送達正確的目的地。

在完整的幀結構中，一般會包含以下部分：

- **前導碼**（Preamble）：幀的開始，通常用於同步(時鐘)。
- **目的地址（DA）**：幀的接收者MAC地址。
- **源地址（SA）**：幀的發送者MAC地址。
- **類型/長度**：指示幀中包含的數據類型或幀的長度。
- **數據負載**：實際傳輸的數據。
- **尾部（Trailer）**：通常包含CRC或其他錯誤檢查碼。

### 例子：

假設有一個幀的基本結構如下：

| Preamble | DA           | SA           | Type/Length | Data        | Trailer   |
|----------|--------------|--------------|--------------|-------------|-----------|
| 7 bytes  | 6 bytes      | 6 bytes      | 2 bytes      | 46-1500 bytes| 4 bytes   |
![[Pasted image 20241024145648.png]]