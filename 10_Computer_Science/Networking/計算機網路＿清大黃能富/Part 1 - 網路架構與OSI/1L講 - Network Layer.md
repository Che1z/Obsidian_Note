2024/10/24

![[Pasted image 20241024150659.png]]
`Network layer`採取`best effort`傳輸形式傳輸封包
### 網路層（Network Layer）

1. **網路層的職責**：
    
    - 網路層是OSI模型的第三層，它負責在不同的網路節點之間進行資料的傳遞。
    - 這一層主要解決的是<mark style="background: #FFF3A3A6;">路徑選擇（routing）以及將封包從來源端傳輸到目標端</mark>的過程。
1. **不可靠的傳輸**：
    
    - 網路層的傳輸方式被稱為「**不可靠傳輸**」，這是因為網路層不保證資料會按順序到達，也不保證資料能夠成功送達目標端。這種傳輸方式是基於「<mark style="background: #FFF3A3A6;">最佳努力」（Best Effort）</mark>的方式來傳送封包，亦即它會盡力將封包送達目的地，但如果出現資料丟失或錯誤，網路層不會進行重新傳輸。
    - 網路層的主要協議是**IP**（Internet Protocol），而IP協議不負責傳輸的可靠性，因此需要更高層的協議如TCP來確保資料的可靠性。
3. **路由器（Router）與路由表（Routing Table）**：
    
    - 路由器是網路層的核心設備，負責將封包從一個網段轉送到另一個網段。
      路由器之間會進行網路狀態的更新，這些狀態變更會被記錄在路由表（Routing Table）中。
    - 路由表保存了目的網路和下一跳路由器之間的對應關係。每個路由器會根據它的路由表來決定下一步該將封包轉發到哪裡。
4. **動態路由更新**：
    
    - 路由器會動態更新網路的狀態。透過<mark style="background: #FFF3A3A6;">動態Routing Protocol</mark>**（如RIP、OSPF、BGP等），路由器之間會交換網路拓撲資訊，以便即時了解網路中的變化（例如路由器故障或網路擁塞），從而動態調整路徑，選擇最優的路徑來傳送封包。
    - 這些動態路由更新的結果會寫入路由器的路由表中，從而確保封包傳輸經由最佳路徑。
5. **封包的轉發**：
    
    - 當路由器收到一個封包時，它首先會查看該封包的**目的地址（DA, Destination Address）**。這個目的地址通常是IP地址。
    - 路由器會檢查其路由表，找到對應的下一跳（Next Hop），也就是下一個要將封包轉送到的路由器或設備。
    - 找到路由後，路由器將封包轉送到下一個設備，直到封包到達最終目的地。
      
      

### 常見的路由協議：

1. **RIP (Routing Information Protocol)**：
    
    - **特點**：RIP 是一種距離向量協議（Distance Vector Protocol），它使用**跳數（Hop Count）** 作為度量來選擇路徑。
    - **工作方式**：RIP 每隔30秒會向鄰近的路由器廣播它的整張路由表。每個路由器會根據接收到的資訊來更新自己的路由表。
    - **缺點**：因為RIP的最大跳數限制為15跳，因此它只適合小型網路。它的更新過程比較慢，也不適合大規模網路。
2. **OSPF (Open Shortest Path First)**：
    
    - **特點**：OSPF 是一種鏈路狀態協議（Link State Protocol），它使用**鏈路狀態算法（如Dijkstra算法）** 來計算最短路徑。
    - **工作方式**：每個路由器會向整個網路發送它的鏈路狀態更新，這些更新只在網路狀態改變時傳播，減少了網絡負擔。OSPF 將網路分為多個區域（Areas），可以有效管理大型網路。
    - **優點**：OSPF 具有快速的收斂性，適合大型、複雜的網路環境。
3. **BGP (Border Gateway Protocol)**：
    
    - **特點**：BGP 是一種矢量路徑協議（Path Vector Protocol），主要用於不同自治系統（AS, Autonomous Systems）之間的路由決策，因此是互聯網的核心路由協議。
    - **工作方式**：BGP 根據路由器之間的政策（Policy）選擇路徑，而不是僅僅基於度量。每個路徑會攜帶經過的自治系統的信息，這讓BGP可以進行基於策略的路由選擇。
    - **應用場景**：BGP 主要用於大型網路，如互聯網服務提供商（ISP）之間的路由更新。




